<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Images player</title>
        <!--<link rel="stylesheet" href="Css/image.css">-->

    </head>
    <style>
        body{
            background-color: black;
            }
        #canvas {
            width: 600px;
            height: 600px;
            background-color: rgb(174, 96, 177);
            }
        img{
            width: 600px;
            height: 600px;
        }    
    </style>
    <body>
        <div class="slider">
            <div class="slides">
            
                <div id="canvas">
                   <img src= "" id="imgId">
                   <!--<img src="images/3.jpg" alt="">-->
                    
                </div>
                
             

            </div>
            <div class="navigation-manuel">
                <!--<input type="button" value="next">
                <input type="button" value="back">
                 -->
                <button value="Next" id="next" >Next</button>
                <button value="Back" id="back" >Back</button>
               
            </div>
            <div class="navigation-automatique">
                <button value="Start" id="start" >Start</button>
                <button value="Stop" id="stop" >Stop</button>
               
            </div>

        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script src="Scripts/img.js"></script>
        <script> 

        // declaration des variable
            const socket =io() 
            var nb=0;
            var length // longeur de la liste contenat les images
            var list_img // la liste des images
            socket.on('hello', function (data) { // rÃ©ception 'hello'
                console.log('le premier socket arrive ');
                document.getElementById("imgId" ).src = "images/1.png"
            });

            socket.on('src', (arg) => {
                console.log('source image recived: '+arg)
                document.getElementById("imgId" ).src = arg;
            });

            socket.on('list', (arg) => {
                console.log('List of images recived: '+arg)
                list_img=arg
            });

            socket.on('length', (arg) => {
                console.log('longeur de la list recived: '+arg)
                length=arg
            })
                            
            // Ajout evenement boutton next
            document.getElementById("next").addEventListener('click', function (e) {
                console.log('Next button clicked');
                nb=nb+1;
                if(nb>(length-1)){nb=0}
                socket.emit('nb', nb)
                console.log('nb image emitted : '+nb);

            });


            //Ajout evenement boutton back
            document.getElementById("back").addEventListener('click', function (e) {
                console.log('Back button clicked');
                nb=nb-1;
                if(nb<0){nb=(length-1)}
                socket.emit('nb', nb)
                console.log('nb image emitted : '+nb);
            });

            //Ajout evenement boutton start
            document.getElementById("start").addEventListener('click', function (e) {
            console.log('Start button clicked');

            socket.emit('sendlist', nb)
            console.log('send request emitted : '+nb);
           

            var iter=0;
                while(iter<5){
                    setTimeout(Animation,5000);
                    iter++;
                }    

            });

            function Animation(){
                for(img in list_img ){
                    new_src="images/"+list_img[img]
                    console.log(new_src)
                    document.getElementById("imgId" ).src = new_src;
                   
                //On affiche chaque image pendant 2s
                }
            }

            

        </script>
        

    </body>
</html>